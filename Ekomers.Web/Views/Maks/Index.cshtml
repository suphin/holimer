@model IEnumerable<dynamic>
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <title>Google Maps Integration</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.js"></script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBIUbtSrDO-GRMSZ7_M3pV-YBPqTZNkpmk&libraries=drawing"></script>
    <style>
        #map {
            height: 100%;
        }

        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script>
        // WGS84 tanımlaması (EPSG:4326)
        proj4.defs("EPSG:4326", "+proj=longlat +datum=WGS84 +no_defs");

        // TM_MAKS_ITRF_30 tanımlaması
        proj4.defs("EPSG:5254", "+proj=tmerc +lat_0=0 +lon_0=30 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs");
        function wgs84ToTM_MAKS_ITRF_30(lon, lat) {
            var sourceProj = proj4("EPSG:4326");
            var destProj = proj4("EPSG:5254");
            return proj4(sourceProj, destProj, [lon, lat]);
        }

        function tm_maks_itrf_30ToWGS84(x, y) {
            var sourceProj = proj4("EPSG:5254");
            var destProj = proj4("EPSG:4326");
            return proj4(sourceProj, destProj, [x, y]);
        }

        var map;
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 38.7713194030716, lng: 30.517908254915028 },
                zoom: 15
            });

            var roadData = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model));

            console.log(roadData);
            roadData.forEach(function (road) {
                // MinCoordinates ve MaxCoordinates'i dönüştürme
                var minCoord = tm_maks_itrf_30ToWGS84(road.MinCoordinates.Item2, road.MinCoordinates.Item1);
                var maxCoord = tm_maks_itrf_30ToWGS84(road.MaxCoordinates.Item2, road.MaxCoordinates.Item1);

                var minCoord2 = tm_maks_itrf_30ToWGS84(road.MinCoordinates.Item1, road.MinCoordinates.Item2);
                var maxCoord2 = tm_maks_itrf_30ToWGS84(road.MaxCoordinates.Item1, road.MaxCoordinates.Item2);

                console.log(road.MinCoordinates.Item2);
                var path = [
                    { lat: minCoord[1], lng: minCoord[0] },
                    { lat: maxCoord[1], lng: maxCoord[0] }
                ];
                var path2 = [
                    { lat: minCoord2[1], lng: minCoord2[0] },
                    { lat: maxCoord2[1], lng: maxCoord2[0] }
                ];
                console.log(path);
                console.log(path2);
                var roadPath = new google.maps.Polyline({
                    path: path,
                    geodesic: true,
                    strokeColor: '#FF0000',
                    strokeOpacity: 1.0,
                    strokeWeight: 2
                });
             console.log(roadPath);
                roadPath.setMap(map);
            });
        }

        google.maps.event.addDomListener(window, 'load', initMap);
    </script>
</body>
</html>
