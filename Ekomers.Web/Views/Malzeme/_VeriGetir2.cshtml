@model MalzemelerVM
@{
    ViewData["Title"] = "Malzeme Listesi";
    ViewData["Description"] = "Tanımlamalar - Malzeme";
}

@section CSSection
{
        <!--begin::Page Vendors Styles(used by this page)-->
    <link href="~/assets1/plugins/custom/jstree/jstree.bundle.css?v=7.0.5" rel="stylesheet" type="text/css" />
    <!--end::Page Vendors Styles-->
 
}
<div class="card card-custom">
    <div class="card-header card-header-tabs-line">
        <div class="card-title">
            <h3 class="card-label">@Model.ModalTitle</h3>
        </div>
        <div class="card-toolbar">
            <ul class="nav nav-tabs nav-bold nav-tabs-line">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#kt_tab_pane_1_4">
                        <span class="nav-icon"><i class="flaticon2-search"></i></span>
                        <span class="nav-text">Detaylar</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#kt_tab_pane_2_4">
                        <span class="nav-icon"><i class="flaticon2-document"></i></span>
                        <span class="nav-text">Dosyalar</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#kt_tab_pane_3_4">
                        <span class="nav-icon"><i class="flaticon-exclamation-1"></i></span>
                        <span class="nav-text">Fiyatlar</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="card-body">
        <div class="tab-content">
            <div class="tab-pane fade show active" id="kt_tab_pane_1_4" role="tabpanel" aria-labelledby="kt_tab_pane_1_4">
                <form asp-controller="@Model.ControllerName" asp-action="VeriEkle" method="post" name="_VeriEkle2" id="_VeriEkle2">
                    @{
                        await Html.RenderPartialAsync("_form", Model);
                    }
                    <div class="text-right mt-3">
                        <input type="hidden" asp-for="ID" />
                        <input type="hidden" asp-for="CreateDate" />
                        <input type="hidden" asp-for="UpdateDate" value="@DateTime.Now" />
                        <input type="hidden" asp-for="IsActive" value="true" />
                        <input type="hidden" asp-for="IsDelete" value="false" />
                        <input type="hidden" asp-for="CreateUserID" value="@Model.CreateUserID" />
                        <input type="hidden" asp-for="UpdateUserID" value="@Model.UserID" />
                        <button type="button" class="btn btn-danger" onclick="javascript:history.back()">Geri Dön</button>
                        <button type="submit" class="btn btn-success">Kaydet</button>
                    </div>
                </form>
            </div>
            <div class="tab-pane fade" id="kt_tab_pane_2_4" role="tabpanel" aria-labelledby="kt_tab_pane_2_4">
                @{
                    @await Component.InvokeAsync("CrmDosyaYonetimi",
                    new { VeriID = Model.ID, ModulID = (int)ModulEnum.Malzeme, DosyaYolu = "Malzemeler" })
                                }
            </div>
            <div class="tab-pane fade" id="kt_tab_pane_3_4" role="tabpanel" aria-labelledby="kt_tab_pane_2_4">
                <div class="col-lg-6">
                    @{
                        @await Component.InvokeAsync("MalzemeFiyatYonetimi",
                        new { VeriID = Model.ID, DosyaYolu = "Malzemeler" })
                                        }
                </div>
               
            </div>
        </div>
    </div>
</div>
@* <script type="text/javascript">


    $(document).ready(function () {

        // Formun submit olayı
        $('#_VeriEkle2').on('submit', function (e) {
            e.preventDefault();
            var form = $(this);
            var actionUrl = form.attr('action');
            var formData = form.serialize();
            $.ajax({
                type: 'POST',
                url: actionUrl,
                data: formData,
                success: function (response) {
                    $('#cardBody').html(response);
                    $('#ModalVeri').modal('hide');
                    toastr.success('Kaydetme İşlemi Başarılı', 'Başarılı');

                },
                error: function (xhr, status, error) {

                    toastr.error('Açıklama:' + xhr.responseText, 'Hata!');
                }
            });
        });
    });

</script> *@
@{
    await Html.RenderPartialAsync("_PartialModalDosya",
    new AuthorizeCrudVM { Controller = "Malzeme", HaritaEkle = false });
}
@section JSSection {

    @{
        await Html.RenderPartialAsync("~/Views/Malzeme/SelectList.Scripts.cshtml");
    }

    @{
        await Html.RenderPartialAsync("~/Views/Sehirler/_SehirlerScript.cshtml");
    }

    <script src="js/select2.js?v=7.0.5"></script>
    <!--begin::Page Vendors(used by this page)-->
    <script src="~/assets1/plugins/custom/jstree/jstree.bundle.js?v=7.0.5"></script>
    <!--end::Page Vendors-->

    

   
  

    <script>

        function KategoriGetir(id,grupad) {

            // Gelen id değerini hidden input'a ekliyoruz
            document.getElementById("GrupID").value = id;
            document.getElementById("Grup").value = grupad;


        }


        var KTTreeview = function () {

            var _demo1 = function () {
                $('#kt_tree_1').jstree({
                    "core": {
                        "themes": {
                            "responsive": false
                        }
                    },
                    "types": {
                        "default": {
                            "icon": "fa fa-folder text-success"
                        },
                        "file": {
                            "icon": "fa fa-file"
                        }
                    },
                    "plugins": ["types"]
                });
            }



            return {
                //main function to initiate the module
                init: function () {
                    _demo1();
                }
            };
        }();

        jQuery(document).ready(function () {
            KTTreeview.init();
        });
    </script>

    <script type="text/javascript">

        $(document).ready(function () {

            // Formun submit olayı
            $('#_VeriEkle2').on('submit', function (e) {
                e.preventDefault();
                var form = $(this);
                var actionUrl = form.attr('action');
                var formData = form.serialize();
                $.ajax({
                    type: 'POST',
                    url: actionUrl,
                    data: formData,
                    success: function (response) {
                        // $('#cardBody').html(response);
                        // $('#ModalVeri').modal('hide');
                        toastr.success('Kaydetme İşlemi Başarılı', 'Başarılı');

                    },
                    error: function (xhr, status, error) {

                        toastr.error('Açıklama:' + xhr.responseText, 'Hata!');
                    }
                });
            });
        });
       
    </script>

    @{
        await Html.RenderPartialAsync("_PartialAuthorizeCrud",
        new AuthorizeCrudVM
        {
            Controller = "Malzeme",
            ModulID = (int)ModulEnum.Malzeme,
            DosyaYolu = "Malzeme"
        });
    }
}
