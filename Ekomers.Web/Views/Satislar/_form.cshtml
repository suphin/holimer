@model SatislarVM
<fieldset @(Model.IsDone ? "disabled" : "")>
<div class="form-group row">
        <div class="col-lg-3 col-md-6">
            <label class="control-label">Müşteri/Hasta </label>
            <input asp-for="CariTipi" type="radio" value="true" name="CariTipi" />
        </div> 
        <div class="col-lg-3 col-md-6">
        <label class="control-label">Personel </label>
        <input asp-for="CariTipi" type="radio" value="false" name="CariTipi" />
    </div>
  
</div>
<div class="form-group row">
     
  
    <div class="col-lg-3">
        <label asp-for="SiparisTarihi" class="control-label"></label>
        <input asp-for="SiparisTarihi" class="form-control form-control-sm" type="date" required/>
        <span asp-validation-for="SiparisTarihi" class="text-danger"></span>
    </div>
        <div class="col-lg-3">
            <label asp-for="SiparisNo" class="control-label"></label>
            <input asp-for="SiparisNo" class="form-control form-control-sm" required />
            <span asp-validation-for="SiparisNo" class="text-danger"></span>

        </div>
        <div class="col-lg-3">
            <label asp-for="PersonelOran" class="control-label"></label>
            <input asp-for="PersonelOran" class="form-control form-control-sm" type="number"
                   step="0.01" />
            <span asp-validation-for="PersonelOran" class="text-danger"></span>
        </div>
        <div class="col-lg-3">
            <label asp-for="MusteriOran" class="control-label"></label>
            <input asp-for="MusteriOran" class="form-control form-control-sm" type="number"
                   step="0.01" />
            <span asp-validation-for="MusteriOran" class="text-danger"></span>

        </div>
</div>
<div class="form-group row">
        <div class="col-lg-3">
            <label asp-for="SorumluAd" class="control-label"></label>
            @if (Model.IsDone)
            {
                <input asp-for="SorumluAd" class="form-control form-control-sm" />
            }
            else
            {
                <select asp-for="SorumluID" class="kt_select2" data-live-search="true" data-size="5" asp-items="@(new SelectList(ViewBag.SorumluListe, "Id", "AdSoyad"))"></select>
                <span asp-validation-for="SorumluAd" class="text-danger"></span>
            }

        </div>
    <div id="personelFields" class="col-lg-9" style="display:@(Model?.CariTipi == false ? "block" : "none")">

       
            <label asp-for="PersonelAd" class="control-label"></label>
            @if(Model.IsDone)
            {
                <input asp-for="PersonelAd" class="form-control form-control-sm" />
                 
            }
            else
            {
            <select asp-for="PersonelID" class="kt_select2" data-live-search="true" data-size="5" asp-items="@(new SelectList(ViewBag.PersonelListe, "Id", "AdSoyad"))"></select>
        <span asp-validation-for="PersonelID" class="text-danger"></span>
            }
        

    </div>
     <div id="cariFields" class="col-lg-6" style="display:@(Model?.CariTipi == true ? "block" : "none")"> 
       @* <div id="cariFields" class="col-lg-6" @(Model?.CariTipi == true ? "" : "hidden")>*@
      
            @{
                // await Html.RenderPartialAsync("~/Views/Musteriler/_selectList.cshtml", Model?.Musteri ?? new Musteriler());
            }
            <partial name="~/Views/Musteriler/_selectList.cshtml" model="Model?.Musteri ?? new Musteriler()" />
       

    </div>
</div> 
<div class="form-group row">
    <div class="col-lg-12">
        <label asp-for="Not" class="control-label"></label>
        <textarea asp-for="Not" type="text" class="form-control form-control-sm" rows="2" required></textarea>
        <span asp-validation-for="Not" class="text-danger"></span>
    </div>
</div>
 
</fieldset>
@if (Model.ID>0)
{
  
    <div id="UrunlerDiv">

    </div>
   
}

<script src="js/select2.js?v=7.0.5"></script>

<script>
    (function () {
      function toggleCariFields() {
        // value "true" seçili mi?
        var CariTipi = document.querySelector('input[name="CariTipi"]:checked')?.value === 'true';
        var wrap = document.getElementById('cariFields');
        var wrap2 = document.getElementById('personelFields');

        if (!wrap) return;
        if (!wrap2) return;

        // İçerideki form elemanları
        var inputs = wrap.querySelectorAll('input, select, textarea');

        if (CariTipi) {
          wrap.style.display = 'block';
          wrap2.style.display = 'none';
          
            $('#cariFields').find(':input').prop('required', true);
          inputs.forEach(function (el) {
            el.disabled = false; // doğrulama/submit'e tekrar dahil et
          });
        } else {
          wrap.style.display = 'none';
          wrap2.style.display = 'block';
           
            $('#cariFields').find(':input').prop('required', false);
          inputs.forEach(function (el) {
            el.disabled = true;  // doğrulamadan ve submit'ten çıkar
            // istersen değerleri de temizle:
            // if (el.type !== 'hidden') el.value = '';
          });
          // Görsel hata mesajlarını temizlemek istersen:
          wrap.querySelectorAll('.text-danger').forEach(function (s) { s.textContent = ''; });
        }
      }

      // Değişimde çalıştır
      document.addEventListener('change', function (e) {
        if (e.target && e.target.name === 'CariTipi') {
          toggleCariFields();
        }
      });

      // Sayfa yüklenince mevcut değere göre ilk ayar
      document.addEventListener('DOMContentLoaded', toggleCariFields);
    })();
</script>


 
