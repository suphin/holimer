@model SatislarUrunlerVM

@{
    var _siparis = (SatislarVM)ViewBag.Siparis;
}
<style>
    /* Mouse ile üzerine gelindiğinde arka plan rengini değiştir */
    #EklenenUrunlerTablo tbody tr:hover {
        background-color: #f0f0f0;
    }
</style>
<style>


    #EklenenUrunlerTablo th {
        height: 18px !important;
        font-size: 11px !important;
        padding: 2px !important;
    }

    #EklenenUrunlerTablo td {
        height: 18px !important;
        font-size: 11px !important;
        padding: 4px !important;
    }
</style>
 

<table class="table table-sm table-bordered TableSmallFont" id="EklenenUrunlerTablo" width="100%" cellspacing="0">
    <thead>
        <tr>
            <th>Sıra No</th>
            <th>Ürün Kodu</th>
            <th>Ürün Adı</th>
            <th>Birim</th>
            <th>Miktar</th>
            <th>Br Maliyet</th>
            <th>Br Fiyat</th>
            <th>MaliyetToplam</th>
            <th>Toplam</th>
            @if (!ViewBag.IsDone)
            {
                <th>Çıkar</th>
            }
            
        </tr>
    </thead>
    <tbody>
        @{
            var sayac = 1;
            double T1 = 0;
            double T2 = 0;
            double T3 = 0;
            double T4 = 0;
        }
        @foreach (SatislarUrunlerVM item in Model.SatislarUrunlerVMListe)
        {

            <tr class="@(item.IsDelete ? "deleted" : "")">
                <td>@sayac</td>
                <td>@item.UrunKod</td>
                <td>@item.UrunAd</td>
                <td>@item.BirimAd</td>
                <td class="text-right">@String.Format("{0:n2}", item.Miktar)</td>
                <td class="text-right">@String.Format("{0:n2}", item.Maliyet) @item.DovizTurAd</td>
                <td class="text-right">@String.Format("{0:n2}", item.Fiyat) @item.DovizTurAd</td>
                <td class="text-right">@String.Format("{0:n2}", item.Maliyet * item.Miktar) @item.DovizTurAd</td>
                <td class="text-right">@String.Format("{0:n2}", item.Fiyat*item.Miktar) @item.DovizTurAd</td>
                        <td>
                        @if (!ViewBag.IsDone)
                        {
                            @if (!item.IsDelete)
                            {
                                <a href="javascript:void(0);" class="remove-item" data-id="@item.ID">Çıkar</a>
                            }
                        }
                    </td>
            </tr>
            sayac = sayac + 1;
            T1 = T1 + (item.Maliyet * item.Miktar);
            T2 = T2 + (item.Fiyat * item.Miktar);
            
        }

    </tbody>
    @if (Model.SatislarUrunlerVMListe.Count > 0)
    {
        T3 = T1 * (double)(_siparis.PersonelOran / 100);
        T4 = T2 * (double)(_siparis.MusteriOran / 100);
        <tfoot>
            <tr>  
                <td class="text-right" colspan="9">
                    <table width="100%" class="table-borderless">

                        <tr>
                            <td class="text-right">Maliyet Toplam     :</td>
                            <td class="text-right">
                              @String.Format("{0:n2}", T1) TL <input name="NetToplam" id="NetToplam" type="hidden" value="@T1" />
                                </td>
                            
                        </tr>
                        <tr>
                            <td class="text-right">Satış Fiyatı Toplamı      :</td>
                            <td class="text-right">@String.Format("{0:n2}", T2) TL <input name="BrutToplam" type="hidden" value="@T2" /></td>
                        </tr>
                        @if (ViewBag.CariTip)
                        {
                            <tr>
                                <td class="text-right">İskonto Toplamı     :</td>
                                <td class="text-right">@String.Format("{0:n2}", T4) TL <input name="SatirIskontoToplam" type="hidden" value="@T4" /></td>
                            </tr>
                        }
                        else
                        {
                            <tr>
                                <td class="text-right">Kar Marjı  :</td>
                                <td class="text-right">@String.Format("{0:n2}", T3) TL <input name="SatirIskontoToplam" type="hidden" value="@T3" /></td>
                            </tr>
                        }                      
                        <tr>
                            <td colspan="2"><hr /></td>
                        </tr>
                        @if (ViewBag.CariTip)
                        {
                            <tr>
                                <td class="text-right bold">Ara Toplam         :</td>
                                <td class="text-right bold">@String.Format("{0:n2}", T2 - T4) TL <input name="aratoplam" type="hidden" value="@(T2 - T4)" /></td>
                            </tr>
                        }
                        else
                        {
                            <tr>
                                <td class="text-right bold">Ara Toplam         :</td>
                                <td class="text-right bold">@String.Format("{0:n2}", T1 + T3) TL <input name="aratoplam" type="hidden" value="@(T1 + T3)" /></td>
                            </tr>
                        } 
                       
                        
                    </table>

                </td>
            </tr>
        </tfoot>
    }


</table>
 